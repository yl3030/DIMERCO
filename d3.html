<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>D3: Add Elements</title>
    <!-- <script src="https://d3js.org/d3.v4.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.6.0/d3.min.js"></script> -->
    <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
  </head>
  <body>
    <!-- <div id="my_dataviz"></div> -->
    <svg width="300" height="300"></svg>

    <script src="./public/js/d3/d3.min.js"></script>

    <script>
      //   const data = [2600000, 3700000, 3700000];
      //   const fontData = [22, 44, 34]
      //   const data = [
      //     {
      //       name: "基金",
      //       value: 2600000,
      //     },
      //     {
      //       name: "股票",
      //       value: 3700000,
      //     },
      //     {
      //       name: "現金",
      //       value: 3700000,
      //     },
      //   ];
      //   var data = [
      //     {
      //       name: "基金",
      //       val: 2600000,
      //     },
      //     {
      //       name: "股票",
      //       val: 3700000,
      //     },
      //     {
      //       name: "現金",

      //       val: 3700000,
      //     },
      //   ];
      //   var name = ["基金","股票","現金"];
      //   var fontData = [
      //     {
      //       name: "基金",
      //       value: 2600000,
      //     },
      //     {
      //       name: "股票",
      //       value: 3700000,
      //     },
      //     {
      //       name: "現金",
      //       value: 3700000,
      //     },
      //   ];

      let data = [
        { val: 3000, type: { 3000: 3000} },
        { val: 2939, type: { 2939: 2939} },
        { val: 1000, type: { 1000: 1000} },
      ];
      let dataNew = d3.map(data, function (d) {
        return d.val;
      });
      let fontData = d3.map(data, function (d) {
        return d.type;
      });
      var svg = d3.select("svg");

      var pie = d3.pie();

      var arc = d3.arc().innerRadius(0).outerRadius(100);

      let g = svg.append("g").attr("transform", "translate(150,120)");
      let arcs = g.selectAll("arc").data(pie(dataNew)).enter().append("g");
      let font = g.selectAll("arc").data(pie(fontData)).enter().append("g");

      arcs
        .append("path")
        .attr("fill", (data, i) => {
          //   let value = data;
          console.log(data, i, "test");
          return d3.schemeSet3[i];
        })
        .attr("d", arc);

      font
        .append("text")
        .attr("transform", (d) => {
          console.log(d, "test3");
          return "translate(" + arc.centroid(d) + ")";
        })
        .text(function (d) {
           let er = Object.keys(d.data)
          console.log( Number(er));
          let fg = Number(er)
          return fg;
        });
    </script>
  </body>
</html>
